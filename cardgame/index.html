<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>전략 카드 게임</title>
<style>
body {
    background: #0f0f0f;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
}
h1 { margin-bottom: 20px; }

#cardPool, #playerDeckDiv {
    display: flex;
    justify-content: center;
    gap: 5px;
    flex-wrap: wrap;
    margin-bottom: 15px;
}

.card {
    background: #1c1c1c;
    width: 50px;
    height: 70px;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 8px;
    cursor: pointer;
    font-size: 18px;
    user-select: none;
    transition: 0.2s;
}
.card:hover { transform: scale(1.1); background: #2a2a2a; }

#log { min-height: 60px; margin-top: 20px; }
button { padding: 6px 12px; margin: 3px; cursor: pointer; }

#rulesModal {
    display: none;
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: #1c1c1c;
    padding: 20px;
    border-radius: 10px;
    width: 300px;
}
#backBtn, #rulesBtn {
    position: fixed;
    padding: 8px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    z-index: 9999;
}
#backBtn { top: 20px; left: 20px; background: #0a84ff; color:white; }
#rulesBtn { top: 20px; right: 20px; background: #ff9500; color:white; }
</style>
</head>
<body>

<h1>전략 카드 게임</h1>

<button id="backBtn">&lt; 돌아가기</button>
<button id="rulesBtn">규칙</button>

<div id="rulesModal">
    <h3>게임 규칙</h3>
    <p>
        1~20 숫자 카드 20장 뒤집힘<br>
        플레이어와 컴퓨터가 한 장씩 번갈아 뽑아 10장 덱 구성<br>
        플레이어 덱 숫자 확인 후 전략 구성<br>
        한 턴마다 카드 1장 선택 → 컴퓨터 카드 랜덤 선택<br>
        큰 숫자가 작은 숫자를 이기지만 1은 20에게 승리<br>
        10턴 후 이긴 횟수 많은 사람 승리
    </p>
    <button onclick="closeRules()">닫기</button>
</div>

<h3>카드 풀</h3>
<div id="cardPool"></div>

<h3>내 덱</h3>
<div id="playerDeckDiv"></div>

<div id="log">카드를 섞는 중...</div>

<script>
const totalCards = 20;
let cardPool = [];
let playerDeck = [];
let compDeck = [];
let turn = 1;
let playerWins = 0;
let compWins = 0;

// DOM
const poolDiv = document.getElementById('cardPool');
const playerDiv = document.getElementById('playerDeckDiv');
const logDiv = document.getElementById('log');

document.getElementById('backBtn').onclick = ()=>{ location.href='../'; };
document.getElementById('rulesBtn').onclick = ()=>{ document.getElementById('rulesModal').style.display='block'; };
function closeRules(){ document.getElementById('rulesModal').style.display='none'; }

// 카드 풀 생성
function createPool(){
    cardPool = Array.from({length:totalCards},(_,i)=>i+1);
    renderPool();
}

// 카드 풀 렌더
function renderPool(){
    poolDiv.innerHTML='';
    cardPool.forEach((c,i)=>{
        const div = document.createElement('div');
        div.className='card';
        div.textContent='?';
        div.onclick=()=>drawCard(i);
        poolDiv.appendChild(div);
    });
}

// 카드 뽑기
function drawCard(index){
    if(playerDeck.length>=10) return; // 덱 구성 완료

    // 플레이어 카드 뽑기
    const playerCard = cardPool.splice(index,1)[0];
    playerDeck.push(playerCard);

    // 컴퓨터 랜덤 카드 뽑기
    const compIndex = Math.floor(Math.random()*cardPool.length);
    const compCard = cardPool.splice(compIndex,1)[0];
    compDeck.push(compCard);

    renderPool();
    renderPlayerDeck();

    if(playerDeck.length===10){
        logDiv.textContent='덱 구성 완료! 카드 클릭해서 턴 진행.';
    } else {
        logDiv.textContent=`덱 구성 중... 남은 카드: ${cardPool.length}`;
    }
}

// 내 덱 렌더
function renderPlayerDeck(){
    playerDiv.innerHTML='';
    playerDeck.forEach((c,i)=>{
        const div = document.createElement('div');
        div.className='card';
        div.textContent=c;
        div.onclick=()=>playTurn(i);
        playerDiv.appendChild(div);
    });
}

// 턴 진행
function playTurn(cardIndex){
    if(cardIndex>=playerDeck.length || playerDeck.length===0) return;

    const playerCard = playerDeck.splice(cardIndex,1)[0];
    const compCard = compDeck.splice(Math.floor(Math.random()*compDeck.length),1)[0];

    // 승리 판단
    let result='';
    if(playerCard===1 && compCard===20){ result='승리!'; playerWins++; }
    else if(playerCard===20 && compCard===1){ result='패배'; compWins++; }
    else if(playerCard>compCard){ result='승리!'; playerWins++; }
    else if(playerCard<compCard){ result='패배'; compWins++; }
    else{ result='무승부'; }

    logDiv.innerHTML=`턴 ${turn}: 당신 ${playerCard} vs 컴퓨터 ${compCard} → ${result}<br>
    남은 카드: ${playerDeck.length}`;

    turn++;
    renderPlayerDeck();

    if(playerDeck.length===0){
        let final = playerWins>compWins ? '최종 승리!' : (playerWins<compWins ? '최종 패배' : '무승부');
        logDiv.innerHTML+=`<br>게임 종료! 최종 결과: ${playerWins} - ${compWins} | ${final}`;
    }
}

// 초기화
function startGame(){
    cardPool=[];
    playerDeck=[];
    compDeck=[];
    turn=1; playerWins=0; compWins=0;
    logDiv.textContent='카드를 섞는 중...';
    createPool();
}

startGame();
</script>

</body>
</html>
