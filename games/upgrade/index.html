<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë¬´ê¸° ê°•í™” ì‹œë®¬ë ˆì´í„°</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #111;
            color: #fff;
            font-family: Arial, sans-serif;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #backBtn {
            position: fixed;
            top: 10px;
            left: 10px;
            padding: 8px 12px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        .box {
            width: 300px;
            background: #1a1a1a;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        button {
            width: 100%;
            padding: 10px;
            margin: 6px 0;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
        }

        #upgradeBtn { background: #3b82f6; color: white; }
        #sellBtn { background: #f59e0b; color: black; }
        #attendanceBtn { background: #16a34a; color: white; }

        #gold { color: #facc15; margin: 8px 0; font-weight: bold; }

        #log { min-height: 24px; margin: 10px 0; color: #facc15; }

        .collection {
            max-height: 120px;
            overflow-y: auto;
            background: #0f0f0f;
            padding: 6px;
            border-radius: 6px;
            font-size: 12px;
            margin-top: 10px;
        }

        .item {
            background: #222;
            margin-bottom: 4px;
            padding: 4px;
            border-radius: 4px;
        }
    </style>
</head>
<body>

<button id="backBtn" onclick="goBack()">â† ë’¤ë¡œê°€ê¸°</button>

<div class="box">
    <h2 id="weaponName">ë‚¡ì€ ê²€</h2>
    <div id="weaponLevel">+0</div>
    <div id="gold">ğŸ’° 0 G</div>

    <button id="upgradeBtn" onclick="upgrade()">ê°•í™”í•˜ê¸° (20G)</button>
    <button id="sellBtn" onclick="sellWeapon()">ë¬´ê¸° íŒë§¤</button>
    <button id="attendanceBtn" onclick="checkAttendance()">ì¶œì„ ì²´í¬</button>

    <div id="log">ê°•í™”ë¥¼ ì‹œì‘í•˜ì„¸ìš”.</div>

    <div class="collection" id="collection"></div>
</div>

<script>
    let level = 0;
    let gold = 0;
    const upgradeCost = 20;

    const stageNames = ["ë‚¡ì€", "ë‹¨ë‹¨í•œ", "ê°•ì² ", "ë¶ˆíƒ€ëŠ”", "ìš©ì˜"];
    const extras = ["ë‚ ì¹´ë¡œìš´", "ë¬µì§í•œ", "ë¹›ë‚˜ëŠ”", "ì €ì£¼ë°›ì€", "ì‹ ì„±í•œ", "ê´‘í­í•œ"];

    function getWeaponName() {
        const stage = stageNames[Math.min(Math.floor(level / 5), stageNames.length - 1)];
        const extra = extras[level % extras.length];
        return level === 0 ? `${stage} ê²€` : `${stage} ${extra} ê²€`;
    }

    function upgrade() {
        if (gold < upgradeCost) {
            log("ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!");
            return;
        }

        gold -= upgradeCost;
        updateGold();

        const r = Math.random();

        if (r < 0.70) {
            level++;
            log("ê°•í™” ì„±ê³µ! +1");
        } else if (r < 0.90) {
            log("ê°•í™” ì‹¤íŒ¨â€¦ ë³€í™” ì—†ìŒ");
        } else if (r < 0.98) {
            if (level > 0) {
                level--;
                log("ê°•í™” í•˜ë½! -1");
            } else {
                log("ê°•í™” ì‹¤íŒ¨â€¦ ë³€í™” ì—†ìŒ");
            }
        } else {
            log("ğŸ’¥ ë¬´ê¸° íŒŒê´´! ìƒˆ ë¬´ê¸° ì§€ê¸‰");
            resetWeapon();
            return;
        }

        updateWeapon();
    }

    function resetWeapon() {
        level = 0;
        updateWeapon();
    }

    function updateWeapon() {
        const name = getWeaponName();
        document.getElementById("weaponName").innerText = name;
        document.getElementById("weaponLevel").innerText = "+" + level;
        addToCollection(name);
    }

    function addToCollection(name) {
        const div = document.createElement("div");
        div.className = "item";
        div.innerText = name;
        document.getElementById("collection").appendChild(div);
    }

    function sellWeapon() {
        if (level === 0) {
            log("ê¸°ë³¸ ë¬´ê¸°ëŠ” íŒë§¤í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            return;
        }

        const price = level * 30;
        gold += price;
        log(`+${level} ë¬´ê¸°ë¥¼ ${price}Gì— íŒë§¤í–ˆìŠµë‹ˆë‹¤.`);
        updateGold();
        resetWeapon();
    }

    function updateGold() {
        document.getElementById("gold").innerText = `ğŸ’° ${gold} G`;
    }

    function checkAttendance() {
        const today = new Date().toDateString();
        const last = localStorage.getItem("attendance");

        if (last === today) {
            log("ì˜¤ëŠ˜ì€ ì´ë¯¸ ì¶œì„í–ˆìŠµë‹ˆë‹¤.");
            return;
        }

        gold += 100;
        updateGold();
        localStorage.setItem("attendance", today);
        log("ì¶œì„ ë³´ìƒ 100G ì§€ê¸‰!");
    }

    function log(msg) {
        document.getElementById("log").innerText = msg;
    }

    function goBack() {
        alert("ë©”ì¸ í˜ì´ì§€ëŠ” ë‚˜ì¤‘ì— ì—°ê²°í•˜ì ğŸ˜");
    }

    updateWeapon();
    updateGold();
</script>

</body>
</html>
