<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>전략 속성 카드 게임</title>
<style>
body {
    background: #0f0f0f;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
}
h1 { margin-bottom: 20px; }

#playerDeck, #opponentDeck {
    display: flex;
    justify-content: center;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 15px;
}

.card {
    background: #1c1c1c;
    width: 80px;
    height: 100px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    border-radius: 8px;
    cursor: pointer;
    font-size: 12px;
    user-select: none;
    transition: 0.3s;
    perspective: 600px;
    position: relative;
}
.card.flip .front {
    transform: rotateY(0deg);
}
.card.flip .back {
    transform: rotateY(180deg);
}
.front, .back {
    position: absolute;
    width: 100%; height: 100%;
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    border-radius: 8px;
    transition: transform 0.5s;
    font-size: 12px;
}
.front { transform: rotateY(180deg); background:#1c1c1c; }
.back { transform: rotateY(0deg); background:#2a2a2a; }

.card.retired { opacity: 0.3; cursor: default; }

#log { min-height: 80px; margin-top: 20px; }
button { padding: 6px 12px; margin: 3px; cursor: pointer; }

#rulesModal {
    display: none;
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: #1c1c1c;
    padding: 20px;
    border-radius: 10px;
    width: 350px;
    text-align: left;
}
#backBtn, #rulesBtn {
    position: fixed;
    padding: 8px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    z-index: 9999;
}
#backBtn { top: 20px; left: 20px; background: #0a84ff; color:white; }
#rulesBtn { top: 20px; right: 20px; background: #ff9500; color:white; }
</style>
</head>
<body>

<h1>전략 속성 카드 게임</h1>

<button id="backBtn">&lt; 돌아가기</button>
<button id="rulesBtn">규칙</button>

<div id="rulesModal">
    <h3>게임 규칙 & 카드 정보</h3>
    <p>속성 상성 (공격력 ×1.5 if 승, ×0.5 if 패):<br>
        불 &gt; 풀, 풀 &gt; 땅, 땅 &gt; 철, 철 &gt; 노말, 노말 &gt; 물, 물 &gt; 불
    </p>
    <p>카드 정보:</p>
    <ul id="cardInfo"></ul>
    <button onclick="closeRules()">닫기</button>
</div>

<h3>내 덱</h3>
<div id="playerDeck"></div>

<h3>상대 덱</h3>
<div id="opponentDeck"></div>

<div id="log">카드를 뽑는 중...</div>

<script>
// 카드 정의
const allCards = [
    {name:'기사', atk:8, def:5, hp:20, attr:'철'},
    {name:'마법사', atk:6, def:3, hp:15, attr:'불'},
    {name:'용', atk:10, def:7, hp:25, attr:'불'},
    {name:'도적', atk:5, def:4, hp:18, attr:'노말'},
    {name:'궁수', atk:7, def:3, hp:16, attr:'풀'},
    {name:'성직자', atk:4, def:6, hp:20, attr:'물'},
    {name:'늑대', atk:6, def:4, hp:18, attr:'풀'},
    {name:'거인', atk:9, def:8, hp:30, attr:'땅'},
    {name:'좀비', atk:5, def:3, hp:22, attr:'노말'},
    {name:'고블린', atk:4, def:2, hp:15, attr:'철'},
    {name:'정령', atk:6, def:5, hp:17, attr:'물'},
    {name:'해적', atk:7, def:4, hp:19, attr:'불'},
    {name:'닌자', atk:8, def:3, hp:16, attr:'노말'},
    {name:'사제', atk:3, def:6, hp:18, attr:'풀'},
    {name:'엘프', atk:7, def:5, hp:20, attr:'풀'},
    {name:'드래곤', atk:10, def:10, hp:35, attr:'불'},
    {name:'바람정령', atk:5, def:5, hp:15, attr:'물'},
    {name:'트롤', atk:9, def:7, hp:28, attr:'땅'},
    {name:'유령', atk:6, def:2, hp:15, attr:'노말'},
    {name:'곰', atk:8, def:6, hp:25, attr:'철'}
];
const advantage = { '불':'풀','풀':'땅','땅':'철','철':'노말','노말':'물','물':'불' };

let playerDeck = [], compDeck = [], turn=1;
const playerDiv = document.getElementById('playerDeck');
const compDiv = document.getElementById('opponentDeck');
const logDiv = document.getElementById('log');

document.getElementById('backBtn').onclick = ()=>{ location.href='../'; };
document.getElementById('rulesBtn').onclick = ()=>{ document.getElementById('rulesModal').style.display='block'; };
function closeRules(){ document.getElementById('rulesModal').style.display='none'; }

// 카드 정보 모달
const cardInfoUl = document.getElementById('cardInfo');
allCards.forEach(c=>{
    const li = document.createElement('li');
    li.textContent=`${c.name}: ATK ${c.atk}, DEF ${c.def}, HP ${c.hp}, 속성 ${c.attr}`;
    cardInfoUl.appendChild(li);
});

// 덱 랜덤 뽑기
function drawDecks(){
    let pool = [...allCards];
    for(let i=0;i<5;i++){
        let pIndex=Math.floor(Math.random()*pool.length);
        playerDeck.push({...pool.splice(pIndex,1)[0]});
        let cIndex=Math.floor(Math.random()*pool.length);
        compDeck.push({...pool.splice(cIndex,1)[0]});
    }
    renderDecks();
    logDiv.textContent='덱 구성 완료! 카드 선택해서 턴 진행.';
}

// 덱 렌더
function renderDecks(){
    playerDiv.innerHTML=''; compDiv.innerHTML='';
    playerDeck.forEach((c,i)=>{
        const div=document.createElement('div'); div.className='card';
        div.innerHTML=`<div class="front"></div><div class="back">${c.name}<br>HP:${c.hp}<br>${c.attr}</div>`;
        div.onclick=()=>playTurn(i);
        if(c.hp<=0) div.classList.add('retired');
        playerDiv.appendChild(div);
    });
    compDeck.forEach(c=>{
        const div=document.createElement('div'); div.className='card flip';
        div.innerHTML=`<div class="front"></div><div class="back">HP:${c.hp}</div>`;
        if(c.hp<=0) div.classList.add('retired');
        compDiv.appendChild(div);
    });
}

// 턴 진행
function playTurn(cardIndex){
    if(cardIndex>=playerDeck.length || playerDeck.length===0) return;

    const playerCard = playerDeck[cardIndex];
    const compCardIndex = Math.floor(Math.random()*compDeck.length);
    const compCard = compDeck[compCardIndex];

    // 카드 뒤집기 애니메이션
    const playerDivs = playerDiv.children;
    const compDivs = compDiv.children;
    playerDivs[cardIndex].classList.add('flip');
    compDivs[compCardIndex].classList.add('flip');

    // 속성 상성
    let dmgMultiplier = 1;
    if(advantage[playerCard.attr]===compCard.attr) dmgMultiplier=1.5;
    else if(advantage[compCard.attr]===playerCard.attr) dmgMultiplier=0.5;

    // 데미지 계산
    const playerDmg = Math.max(playerCard.atk - compCard.def,0) * dmgMultiplier;
    const compDmg = Math.max(compCard.atk - playerCard.def,0) * dmgMultiplier;

    compCard.hp -= playerDmg; playerCard.hp -= compDmg;

    let resultMsg=`턴 ${turn}: ${playerCard.name} vs ${compCard.name}<br>`;
    resultMsg+=`${playerCard.name}가 ${playerDmg.toFixed(1)} 데미지, ${compCard.name}가 ${compDmg.toFixed(1)} 데미지<br>`;

    // 리타이어 체크
    if(compCard.hp<=0){ compDeck.splice(compCardIndex,1); resultMsg+=`${compCard.name} 리타이어!<br>`; }
    if(playerCard.hp<=0){ playerDeck.splice(cardIndex,1); resultMsg+=`${playerCard.name} 리타이어!<br>`; }

    logDiv.innerHTML = resultMsg;
    renderDecks();
    turn++;

    // 게임 종료 체크
    if(playerDeck.length===0 || compDeck.length===0){
        let final='';
        if(playerDeck.length>compDeck.length) final='최종 승리!';
        else if(playerDeck.length<compDeck.length) final='최종 패배!';
        else final='무승부!';
        logDiv.innerHTML+=`<br>게임 종료! ${final}`;
    }
}

// 시작
drawDecks();
</script>
</body>
</html>

