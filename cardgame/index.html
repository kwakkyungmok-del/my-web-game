<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>턴제 카드 전투</title>
<style>
body {
    background: #0f0f0f;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
}
h1 { margin-bottom: 20px; }
.cards {
    display: flex;
    justify-content: center;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 20px;
}
.card {
    background: #1c1c1c;
    padding: 15px;
    border-radius: 8px;
    cursor: pointer;
    transition: 0.2s;
    width: 50px;
}
.card:hover {
    transform: scale(1.1);
    background: #2a2a2a;
}
#log { margin-top: 20px; min-height: 60px; }
button { padding: 8px 12px; margin: 5px; cursor: pointer; }
#rulesModal {
    display: none;
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: #1c1c1c;
    padding: 20px;
    border-radius: 10px;
    width: 300px;
    box-shadow: 0 0 10px #000;
}
#rulesModal button { margin-top: 10px; }
#backBtn, #rulesBtn {
    position: fixed;
    z-index: 9999;
    padding: 8px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}
#backBtn { top: 20px; left: 20px; background: #0a84ff; color:white; }
#rulesBtn { top: 20px; right: 20px; background: #ff9500; color:white; }
</style>
</head>
<body>

<h1>턴제 카드 전투</h1>

<!-- 좌상단/우상단 버튼 -->
<button id="backBtn">&lt; 돌아가기</button>
<button id="rulesBtn">규칙</button>

<!-- 규칙 모달 -->
<div id="rulesModal">
    <h3>게임 규칙</h3>
    <p>1~20 숫자 카드 10장씩 소지<br>
    큰 숫자가 작은 숫자를 이기지만 1은 20을 이김<br>
    플레이어 카드 클릭 → 컴퓨터 카드와 비교 → 승리 횟수 누적<br>
    모든 카드 소진 시 최종 승리 결정</p>
    <button onclick="closeRules()">닫기</button>
</div>

<!-- 카드 영역 -->
<div class="cards" id="playerCards"></div>

<div id="log">카드를 섞는 중...</div>

<script>
const totalCards = 10;
let playerDeck = [];
let compDeck = [];
let playerScore = 0;
let compScore = 0;

// DOM
const playerDiv = document.getElementById('playerCards');
const logDiv = document.getElementById('log');

// 버튼 기능
document.getElementById('backBtn').onclick = ()=>{ location.href='../'; };
document.getElementById('rulesBtn').onclick = ()=>{ document.getElementById('rulesModal').style.display='block'; };
function closeRules(){ document.getElementById('rulesModal').style.display='none'; }

// 카드 생성 함수
function shuffleDeck(){
    const numbers = Array.from({length:20},(_,i)=>i+1);
    playerDeck = [];
    compDeck = [];
    for(let i=0;i<totalCards;i++){
        let idx = Math.floor(Math.random()*numbers.length);
        playerDeck.push(numbers.splice(idx,1)[0]);
        idx = Math.floor(Math.random()*numbers.length);
        compDeck.push(numbers.splice(idx,1)[0]);
    }
}

// 턴 진행
function playTurn(card){
    // 플레이어 카드 제거
    playerDeck = playerDeck.filter(c=>c!==card);

    // 컴퓨터 랜덤 카드 선택
    const compCard = compDeck.splice(Math.floor(Math.random()*compDeck.length),1)[0];

    // 승리 판단
    let result = '';
    if(card===1 && compCard===20){
        result='승리!';
        playerScore++;
    } else if(card===20 && compCard===1){
        result='패배';
        compScore++;
    } else if(card>compCard){
        result='승리!';
        playerScore++;
    } else if(card<compCard){
        result='패배';
        compScore++;
    } else{
        result='무승부';
    }

    logDiv.innerHTML=`당신: ${card} vs 컴퓨터: ${compCard} → ${result}<br>
    남은 카드: ${playerDeck.length}`;

    renderCards();

    // 게임 종료 체크
    if(playerDeck.length===0){
        let final = playerScore>compScore ? '최종 승리!' : (playerScore<compScore ? '최종 패배' : '무승부');
        logDiv.innerHTML+=`<br>게임 종료! 최종 점수: ${playerScore} - ${compScore} | ${final}`;
    }
}

// 카드 표시
function renderCards(){
    playerDiv.innerHTML='';
    playerDeck.forEach(c=>{
        const div=document.createElement('div');
        div.className='card';
        div.textContent=c;
        div.onclick=()=>playTurn(c);
        playerDiv.appendChild(div);
    });
}

// 초기화 및 카드 섞는 모션
function startGame(){
    playerScore=0; compScore=0;
    logDiv.textContent='카드를 섞는 중...';
    shuffleDeck();
    setTimeout(()=>{
        logDiv.textContent='카드를 선택하세요.';
        renderCards();
    },800); // 섞는 모션 딜레이
}

startGame();
</script>

</body>
</html>
