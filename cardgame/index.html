<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì „ëµ ì†ì„± ì¹´ë“œ ê²Œì„</title>
<style>
body {
    background: #0f0f0f;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
}
h1 { margin-bottom: 20px; }

#cardPool, #playerDeck, #opponentDeck {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 15px;
}

.card {
    width: 100px;
    height: 140px;
    perspective: 600px;
    cursor: pointer;
    position: relative;
    transition: transform 0.3s;
}

.cardInner {
    width: 100%;
    height: 100%;
    transition: transform 0.5s;
    transform-style: preserve-3d;
    position: relative;
}

.front, .back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-size: 16px;
    text-align: center;
}

.front { background: #1c1c1c; color: white; transform: rotateY(180deg); }
.back { background: #2a2a2a; color: white; }

.selected { border: 3px solid #0a84ff; transform: scale(1.2);}
.retired { opacity:0.3; cursor:default; }

#log { min-height: 80px; margin-top: 20px; }

button { padding: 6px 12px; margin: 3px; cursor: pointer; }

#rulesModal {
    display:none;
    position:fixed; top:50%; left:50%;
    transform:translate(-50%, -50%);
    background:#1c1c1c; padding:15px;
    border-radius:10px;
    width:300px; text-align:left;
    z-index:10000;
}

#backBtn,#rulesBtn,#restartBtn { position:fixed; padding:8px 12px; border:none; border-radius:5px; cursor:pointer; z-index:9999; }
#backBtn{top:20px; left:20px; background:#0a84ff; color:white;}
#rulesBtn{top:20px; right:20px; background:#ff9500; color:white;}
#restartBtn{top:60px; right:20px; background:#28a745; color:white; display:none;}

.effect {
    position:absolute; font-size:32px; z-index:1000;
    transition: transform 0.7s linear, opacity 0.7s linear;
}
</style>
</head>
<body>

<h1>ì „ëµ ì†ì„± ì¹´ë“œ ê²Œì„</h1>
<button id="backBtn">&lt; ëŒì•„ê°€ê¸°</button>
<button id="rulesBtn">ê·œì¹™</button>
<button id="restartBtn">ë‹¤ì‹œ ì‹œì‘</button>

<div id="rulesModal">
<h3>ê²Œì„ ê·œì¹™</h3>
<p>
1. ì¹´ë“œ 20ì¥ ì¤‘ 5ì¥ ì„ íƒ í›„ ì „íˆ¬<br>
2. ì†ì„± ìƒì„±: ğŸ”¥>ğŸŒ¿>â›°ï¸>âš”ï¸>ğŸŸ¤>ğŸ’§>ğŸ”¥<br>
3. ì„ íƒí•œ ì¹´ë“œë¡œ ìƒëŒ€ ì¹´ë“œ ì„ íƒ â†’ ê³µê²©<br>
4. ì†ì„± ìœ ë¦¬: 1.5ë°°, ë¶ˆë¦¬: 0.5ë°°, ì ˆë°˜ í”¼í•´ ì ìš©<br>
5. ìƒëŒ€ 5ì¥ ë¦¬íƒ€ì´ì–´ ì‹œ ìŠ¹ë¦¬
</p>
<button onclick="closeRules()">ë‹«ê¸°</button>
</div>

<h3>ì¹´ë“œ í’€ (ë’¤ì§‘íŒ ìƒíƒœ)</h3>
<div id="cardPool"></div>

<h3>ë‚´ ë±</h3>
<div id="playerDeck"></div>

<h3>ìƒëŒ€ ë±</h3>
<div id="opponentDeck"></div>

<div id="log">ì¹´ë“œ í’€ì—ì„œ 5ì¥ì„ ì„ íƒí•˜ì„¸ìš”.</div>

<script>
const allCards=[
{name:'ê¸°ì‚¬',emoji:'ğŸ›¡ï¸',atk:8,def:5,hp:20,attr:'âš”ï¸ì² '},
{name:'ë§ˆë²•ì‚¬',emoji:'ğŸ”¥',atk:6,def:3,hp:15,attr:'ğŸ”¥ë¶ˆ'},
{name:'ìš©',emoji:'ğŸ²',atk:10,def:7,hp:25,attr:'ğŸ”¥ë¶ˆ'},
{name:'ë„ì ',emoji:'ğŸ§¥',atk:5,def:4,hp:18,attr:'ğŸŸ¤ë…¸ë§'},
{name:'ê¶ìˆ˜',emoji:'ğŸ¹',atk:7,def:3,hp:16,attr:'ğŸŒ¿í’€'},
{name:'ì„±ì§ì',emoji:'ğŸ’§',atk:4,def:6,hp:20,attr:'ğŸ’§ë¬¼'},
{name:'ëŠ‘ëŒ€',emoji:'ğŸº',atk:6,def:4,hp:18,attr:'ğŸŒ¿í’€'},
{name:'ê±°ì¸',emoji:'ğŸ‘¹',atk:9,def:8,hp:30,attr:'â›°ï¸ë•…'},
{name:'ì¢€ë¹„',emoji:'ğŸ§Ÿ',atk:5,def:3,hp:22,attr:'ğŸŸ¤ë…¸ë§'},
{name:'ê³ ë¸”ë¦°',emoji:'ğŸ‘º',atk:4,def:2,hp:15,attr:'âš”ï¸ì² '},
{name:'ì •ë ¹',emoji:'ğŸ§š',atk:6,def:5,hp:17,attr:'ğŸ’§ë¬¼'},
{name:'í•´ì ',emoji:'ğŸ´â€â˜ ï¸',atk:7,def:4,hp:19,attr:'ğŸ”¥ë¶ˆ'},
{name:'ë‹Œì',emoji:'ğŸ—¡',atk:8,def:3,hp:16,attr:'ğŸŸ¤ë…¸ë§'},
{name:'ì‚¬ì œ',emoji:'ğŸ™',atk:3,def:6,hp:18,attr:'ğŸŒ¿í’€'},
{name:'ì—˜í”„',emoji:'ğŸ§',atk:7,def:5,hp:20,attr:'ğŸŒ¿í’€'},
{name:'ë“œë˜ê³¤',emoji:'ğŸ‰',atk:10,def:10,hp:35,attr:'ğŸ”¥ë¶ˆ'},
{name:'ë°”ëŒì •ë ¹',emoji:'ğŸŒªï¸',atk:5,def:5,hp:15,attr:'ğŸ’§ë¬¼'},
{name:'íŠ¸ë¡¤',emoji:'ğŸ—¿',atk:9,def:7,hp:28,attr:'â›°ï¸ë•…'},
{name:'ìœ ë ¹',emoji:'ğŸ‘»',atk:6,def:2,hp:15,attr:'ğŸŸ¤ë…¸ë§'},
{name:'ê³°',emoji:'ğŸ»',atk:8,def:6,hp:25,attr:'âš”ï¸ì² '}
];

const advantage={'ğŸ”¥ë¶ˆ':'ğŸŒ¿í’€','ğŸŒ¿í’€':'â›°ï¸ë•…','â›°ï¸ë•…':'âš”ï¸ì² ','âš”ï¸ì² ':'ğŸŸ¤ë…¸ë§','ğŸŸ¤ë…¸ë§':'ğŸ’§ë¬¼','ğŸ’§ë¬¼':'ğŸ”¥ë¶ˆ'};

let playerDeck=[], compDeck=[], turn=1;
let selectedPlayer=null, selectedComp=null;

const cardPoolDiv=document.getElementById('cardPool');
const playerDiv=document.getElementById('playerDeck');
const compDiv=document.getElementById('opponentDeck');
const logDiv=document.getElementById('log');
const restartBtn=document.getElementById('restartBtn');

document.getElementById('backBtn').onclick=()=>{location.href='../';};
document.getElementById('rulesBtn').onclick=()=>{document.getElementById('rulesModal').style.display='block';};
function closeRules(){document.getElementById('rulesModal').style.display='none';}

// ì´ˆê¸°í™”
function initGame(){
    playerDeck=[]; compDeck=[]; turn=1; selectedPlayer=null; selectedComp=null;
    restartBtn.style.display='none';
    renderCardPool();
    renderDecks();
    logDiv.textContent='ì¹´ë“œ í’€ì—ì„œ 5ì¥ì„ ì„ íƒí•˜ì„¸ìš”.';
}

function renderCardPool(){
    cardPoolDiv.innerHTML='';
    allCards.forEach((c,i)=>{
        const div=document.createElement('div');
        div.className='card';
        div.innerHTML=`<div class="cardInner"><div class="front"></div><div class="back"></div></div>`;
        div.onclick=()=>pickCard(i);
        cardPoolDiv.appendChild(div);
    });
}

function pickCard(index){
    if(playerDeck.length>=5) return;
    playerDeck.push({...allCards[index]});
    allCards.splice(index,1);
    renderCardPool();
    renderDecks();
    if(playerDeck.length===5) startBattle();
}

function startBattle(){
    // ì»´í“¨í„° 5ì¥ ëœë¤
    let pool=[...allCards];
    for(let i=0;i<5;i++){
        let idx=Math.floor(Math.random()*pool.length);
        compDeck.push({...pool.splice(idx,1)[0]});
    }
    cardPoolDiv.style.display='none';
    logDiv.textContent='ì¹´ë“œ ì„ íƒ ì™„ë£Œ! ë‚´ ë±ì—ì„œ ê³µê²©í•  ì¹´ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”.';
    renderDecks();
}

function renderDecks(){
    playerDiv.innerHTML=''; compDiv.innerHTML='';
    playerDeck.forEach((c,idx)=>{
        const div=document.createElement('div');
        div.className='card';
        if(selectedPlayer===idx) div.classList.add('selected');
        div.innerHTML=`<div class="cardInner flip" style="transform:rotateY(180deg)">
            <div class="front"></div>
            <div class="back" style="font-size:24px;">${c.emoji}<br>${c.name}<br>${c.attr}<br>HP:${c.hp}</div>
        </div>`;
        if(c.hp<=0) div.classList.add('retired');
        div.onclick=()=>{if(c.hp>0) selectPlayerCard(idx);}
        playerDiv.appendChild(div);
    });

    compDeck.forEach((c,idx)=>{
        const div=document.createElement('div');
        div.className='card';
        if(selectedComp===idx) div.classList.add('selected');
        div.innerHTML=`<div class="cardInner flip" style="transform:rotateY(180deg)">
            <div class="front"></div>
            <div class="back" style="font-size:24px;">${c.emoji}<br>${c.name}<br>${c.attr}<br>HP:${c.hp}</div>
        </div>`;
        if(c.hp<=0) div.classList.add('retired');
        div.onclick=()=>{if(selectedPlayer!==null && c.hp>0) selectCompCard(idx);}
        compDiv.appendChild(div);
    });
}

function selectPlayerCard(idx){
    selectedPlayer=idx;
    renderDecks();
    logDiv.textContent=`${playerDeck[idx].name} ì„ íƒ ì™„ë£Œ! ìƒëŒ€ ì¹´ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”.`;
}

function selectCompCard(idx){
    selectedComp=idx;
    executeAttack();
}

function executeAttack(){
    if(selectedPlayer===null || selectedComp===null) return;
    const pCard=playerDeck[selectedPlayer];
    const cCard=compDeck[selectedComp];

    let dmgMultiplier=1;
    if(advantage[pCard.attr]===cCard.attr) dmgMultiplier=1.5;
    else if(advantage[cCard.attr]===pCard.attr) dmgMultiplier=0.5;

    const pDmg=Math.max(pCard.atk - cCard.def,0) * dmgMultiplier;
    const cDmg=Math.max(cCard.atk - pCard.def,0) * 0.5; // ì ˆë°˜ í”¼í•´

    showEffect(pCard.emoji, playerDiv.children[selectedPlayer], compDiv.children[selectedComp]);
    pCard.hp-=pDmg;
    cCard.hp-=cDmg;

    let msg=`${pCard.name} ê³µê²©! ${pCard.name} ${pDmg.toFixed(1)} ë°ë¯¸ì§€, ${cCard.name} ${cDmg.toFixed(1)} ë°ë¯¸ì§€<br>`;
    if(pCard.hp<=0){ playerDeck.splice(selectedPlayer,1); selectedPlayer=null; msg+=`${pCard.name} ë¦¬íƒ€ì´ì–´!<br>`;}
    if(cCard.hp<=0){ compDeck.splice(selectedComp,1); selectedComp=null; msg+=`${cCard.name} ë¦¬íƒ€ì´ì–´!<br>`;}

    logDiv.innerHTML=msg;

    renderDecks();
    selectedPlayer=null; selectedComp=null;

    // ìŠ¹íŒ¨ ì²´í¬
    if(playerDeck.length===0 || compDeck.length===0){
        let final='';
        if(playerDeck.length>compDeck.length) final='ìŠ¹ë¦¬!';
        else if(playerDeck.length<compDeck.length) final='íŒ¨ë°°!';
        else final='ë¬´ìŠ¹ë¶€!';
        logDiv.innerHTML+=`<br>ê²Œì„ ì¢…ë£Œ! ${final}`;
        restartBtn.style.display='block';
    }
}

function showEffect(emoji, fromElem, toElem){
    const effect=document.createElement('div');
    effect.className='effect';
    effect.textContent=emoji;
    document.body.appendChild(effect);
    const fromRect=fromElem.getBoundingClientRect();
    const toRect=toElem.getBoundingClientRect();
    effect.style.left=fromRect.left + fromRect.width/2 + 'px';
    effect.style.top=fromRect.top + fromRect.height/2 + 'px';
    requestAnimationFrame(()=>{
        effect.style.transform=`translate(${toRect.left - fromRect.left}px, ${toRect.top - fromRect.top}px)`;
        effect.style.opacity='0';
    });
    setTimeout(()=>effect.remove(),700);
}

restartBtn.onclick=()=>{initGame();};
initGame();
</script>
</body>
</html>
