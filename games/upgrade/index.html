<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë¬´ê¸° ê°•í™” ì‹œë®¬ë ˆì´í„°</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #111;
            color: #fff;
            font-family: 'Segoe UI', sans-serif;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #backBtn {
            position: fixed;
            top: 12px;
            left: 12px;
            padding: 6px 12px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        #backBtn:hover {
            background: #555;
        }

        .container {
            width: 320px;
            padding: 20px;
            background: #1a1a1a;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        #weaponName {
            margin: 0;
            font-size: 22px;
        }

        #weaponLevel {
            margin: 6px 0 6px;
            color: #aaa;
        }

        #gold {
            margin: 6px 0 12px;
            color: #facc15;
            font-weight: bold;
        }

        button {
            width: 100%;
            padding: 12px;
            margin-bottom: 8px;
            font-size: 14px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        #upgradeBtn {
            background: #3b82f6;
            color: #fff;
        }

        #upgradeBtn:hover {
            background: #2563eb;
        }

        #sellBtn, #attendanceBtn {
            background: #16a34a;
            color: #fff;
        }

        #sellBtn:hover, #attendanceBtn:hover {
            background: #15803d;
        }

        .log {
            min-height: 24px;
            margin: 10px 0;
            color: #facc15;
        }

        .collection-box {
            background: #0f0f0f;
            padding: 10px;
            border-radius: 8px;
        }

        .collection-box h3 {
            margin: 0 0 6px 0;
            font-size: 14px;
            color: #aaa;
        }

        .collection {
            max-height: 120px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
        }

        .collection-item {
            background: #222;
            padding: 6px;
            border-radius: 6px;
            font-size: 12px;
        }
    </style>
</head>
<body>

<button id="backBtn" onclick="goBack()">â† ë’¤ë¡œê°€ê¸°</button>

<div class="container">
    <h1 id="weaponName">ë‚¡ì€ ê²€</h1>
    <div id="weaponLevel">+0</div>
    <div id="gold">ğŸ’° 0 G</div>

    <button id="upgradeBtn" onclick="upgrade()">ê°•í™”í•˜ê¸° (20G)</button>
    <button id="sellBtn" onclick="sellWeapon()">ë¬´ê¸° íŒë§¤</button>
    <button id="attendanceBtn" onclick="checkAttendance()">ì¶œì„ ì²´í¬</button>

    <div id="log" class="log">ê°•í™”ë¥¼ ì‹œì‘í•˜ì„¸ìš”.</div>

    <div class="collection-box">
        <h3>ğŸ“– ë„ê°</h3>
        <div id="collection" class="collection"></div>
    </div>
</div>

<script>
    let level = 0;
    let destroyed = false;
    let gold = 0;

    const upgradeCost = 20;

    const stageNames = [
        { min: 0, name: "ë‚¡ì€" },
        { min: 5, name: "ë‹¨ë‹¨í•œ" },
        { min: 10, name: "ê°•ì² " },
        { min: 15, name: "ë¶ˆíƒ€ëŠ”" },
        { min: 20, name: "ìš©ì˜" }
    ];

    const extraAdjectives = [
        "ë‚ ì¹´ë¡œìš´", "ë¬µì§í•œ", "ë¹›ë‚˜ëŠ”", "ì €ì£¼ë°›ì€",
        "ì‹ ì„±í•œ", "ê´‘í­í•œ", "ê· ì—´ì˜", "ì‹¬ì—°ì˜"
    ];

    const sellPrices = [
        { min: 0, price: 10 },
        { min: 5, price: 50 },
        { min: 10, price: 150 },
        { min: 15, price: 400 },
        { min: 20, price: 1000 }
    ];

    let discovered = new Set();

    function getStageName() {
        let current = stageNames[0].name;
        for (let stage of stageNames) {
            if (level >= stage.min) current = stage.name;
        }
        return current;
    }

    function getExtraAdjective() {
        if (level === 0) return "";
        return extraAdjectives[level % extraAdjectives.length];
    }

    function getWeaponName() {
        const stage = getStageName();
        const extra = getExtraAdjective();
        return extra ? `${stage} ${extra} ê²€` : `${stage} ê²€`;
    }

    function upgrade() {
        if (gold < upgradeCost) {
            log("ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!");
            return;
        }

        gold -= upgradeCost;
        updateGold();

        if (destroyed) return;

        const chance = Math.random();
        let result = "";

        if (chance < 0.6) {
            level++;
            result = "ì„±ê³µ! ê°•í™” ë‹¨ê³„ ìƒìŠ¹.";
        } else if (chance < 0.8) {
            result = "ì‹¤íŒ¨â€¦ ë³€í™” ì—†ìŒ.";
        } else if (chance < 0.95) {
            if (level > 0) {
                level--;
                result = "ê°•í™” í•˜ë½! ë‹¨ê³„ ê°ì†Œ.";
            } else {
                result = "ì‹¤íŒ¨â€¦ ë³€í™” ì—†ìŒ.";
            }
        } else {
            destroyed = true;
            result = "ğŸ’¥ ë¬´ê¸° íŒŒê´´! ìƒˆ ë¬´ê¸°ë¥¼ ì§€ê¸‰í•©ë‹ˆë‹¤...";
            updateUI(result);
            setTimeout(() => {
                resetWeapon();
            }, 1200);
            return;
        }

        updateUI(result);
    }

    function resetWeapon() {
        level = 0;
        destroyed = false;
        updateUI("ìƒˆë¡œìš´ ë‚¡ì€ ê²€ì„ íšë“í–ˆìŠµë‹ˆë‹¤.");
    }

    function updateUI(message) {
        const name = getWeaponName();

        document.getElementById("weaponName").innerText = name;
        document.getElementById("weaponLevel").innerText = "+" + level;

        if (!discovered.has(name)) {
            discovered.add(name);
            addToCollection(name);
        }

        log(message);
    }

    function log(text) {
        document.getElementById("log").innerText = text;
    }

    function addToCollection(name) {
        const div = document.createElement("div");
        div.className = "collection-item";
        div.innerText = name;
        document.getElementById("collection").appendChild(div);
    }

    function getSellPrice() {
        let price = sellPrices[0].price;
        for (let p of sellPrices) {
            if (level >= p.min) price = p.price;
        }
        return price;
    }

    function sellWeapon() {
        const price = getSellPrice();
        gold += price;
        updateGold();
        resetWeapon();
        log(`ë¬´ê¸°ë¥¼ ${price}Gì— íŒë§¤í–ˆìŠµë‹ˆë‹¤.`);
    }

    function updateGold() {
        document.getElementById("gold").innerText = `ğŸ’° ${gold} G`;
    }

    function checkAttendance() {
        const today = new Date().toDateString();
        const last = localStorage.getItem("attendance");

        if (last === today) {
            log("ì˜¤ëŠ˜ì€ ì´ë¯¸ ì¶œì„ì²´í¬ í–ˆìŠµë‹ˆë‹¤.");
            return;
        }

        const reward = 100;
        gold += reward;
        updateGold();
        localStorage.setItem("attendance", today);
        log(`ì¶œì„ ë³´ìƒìœ¼ë¡œ ${reward}Gë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤!`);
    }

    function goBack() {
        alert("ë’¤ë¡œê°€ê¸°ëŠ” ë‚˜ì¤‘ì— ë©”ì¸ í˜ì´ì§€ ë§Œë“¤ë©´ ì—°ê²°í•˜ì ğŸ˜");
    }

    // ì´ˆê¸°í™”
    updateUI("ê°•í™”ë¥¼ ì‹œì‘í•˜ì„¸ìš”.");
    updateGold();
</script>

</body>
</html>
